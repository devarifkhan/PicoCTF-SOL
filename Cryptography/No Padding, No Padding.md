# Cryptography
## No Padding, No Problem - 90 Points
## Question
> Oracles can be your best friend, they will decrypt anything, except the flag's ciphertext. How will you break it? Connect with nc mercury.picoctf.net 60368.

## Solution
> We got this and some value to decrpyt.
```text
┌──(kali㉿kali)-[~]
└─$ nc mercury.picoctf.net 60368
Welcome to the Padding Oracle Challenge
This oracle will take anything you give it and decrypt using RSA. It will not accept the ciphertext with the secret message... Good Luck!
n: 97721544808900139757812521519876303976026102388950382496395001800062163439315711216488047488463609059614382552367181240890413893686960146015365375008009030972870253541482059717285138498863304938230837142816425051415571620988596791822477861864454467285944109643286585534605417522330996417159579461700649235093
e: 65537
ciphertext: 10657548382703484726289133171759280639470685236372301608135877215621031462963007303266735757715179741091190811262835713927287947607604430681281471296649803056997545259932889883819924241694512720657825742711459318805809738835661408275654418811628731581329477721627075793013671060091028628294848438076011995851
Give me ciphertext to decrypt: 
```
> except the cipher text.
```text
Give me ciphertext to decrypt: 10657548382703484726289133171759280639470685236372301608135877215621031462963007303266735757715179741091190811262835713927287947607604430681281471296649803056997545259932889883819924241694512720657825742711459318805809738835661408275654418811628731581329477721627075793013671060091028628294848438076011995851
Will not decrypt the ciphertext. Try Again
Give me ciphertext to decrypt: 
```

> Now unpadded RSA is homomorphic,which means that,
```text
encrypt(m1) * encrypt(m2) = ((m1**e) * (m2**e)) mod n = (m1 * m2)**e mod n = encrypt(m1 * m2)
```
> So, we can take a known value such as 2, and encrypt it by performing 2**e mod n.
```python
>>> n=71152211706142518930716579420333980864951245671281855574524942871075361180024258207698839160157116179473626457420821625307764565742455364599994967214090790972985094893734601246039140234348036197403093104422055326620138802116216175852538969153123808501606310864693373073580767234387820545826943502632057300979
>>> e=65537
>>> c=20504875534219566063426543290505706394377726248784977763211984455067349015763473765530493434168811405680463351917395758180455937022298035278412212661128918437600125995025217302495179140625713551456350281783430029416339145514040160435863827436258097747493205486345204719352566119180085088044194562097815819926
>>> x=pow(2,e,n)
```
> Now calculate c*x
```python
>>> c*x
707099411770328512555767361283091923516727752499795830079856031436018461025819649855747185717616447341321380930967841081163934642925500719579009521418819547694099875117324742912313023749646994389018104558100535202634278757721517251965340346722541034036123235575638296565990467865309588147846147165828459708974065602452942850990922901850167840653504226230704252780025385904439314680613809751020931528178625127045592615320800532137715451439935139031892193476583943280554114378226788864639662502639885083307634126527704349202446350555913357637112969836807416588699254650869200036647758129818450317780297080920667818198
```
> As explained earlier, c * x = encrypt(m) * encrypt(2) = encrypt(m * 2)
> Let's try to decrypt that:
```text
Give me ciphertext to decrypt: 707099411770328512555767361283091923516727752499795830079856031436018461025819649855747185717616447341321380930967841081163934642925500719579009521418819547694099875117324742912313023749646994389018104558100535202634278757721517251965340346722541034036123235575638296565990467865309588147846147165828459708974065602452942850990922901850167840653504226230704252780025385904439314680613809751020931528178625127045592615320800532137715451439935139031892193476583943280554114378226788864639662502639885083307634126527704349202446350555913357637112969836807416588699254650869200036647758129818450317780297080920667818198
Here you go: 580550060391700078946913236734911770139931497702556153513487440893406629034802718534645538074938502890769138695361576199930
```

> We got m * 2. We take the result and divide back by 2 to get m:
```python
>>> m=580550060391700078946913236734911770139931497702556153513487440893406629034802718534645538074938502890769138695361576199930
>>> m=m//2
>>> bytearray.fromhex(format(m,'x')).decode()
'picoCTF{m4yb3_Th0se_m3s54g3s_4r3_difurrent_3279013}'

```

> Flag is: picoCTF{m4yb3_Th0se_m3s54g3s_4r3_difurrent_3279013}
